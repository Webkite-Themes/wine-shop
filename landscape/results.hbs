{{log this}}

{{>name}}
{{>embed}}

{{>header}}

<div class="webkite-results-wrapper">
  {{#if items.length~}}
    {{#each (groupedItems this.items)~}}
      {{#if @key}}<h1 class="webkite-group-name">{{@key}}</h1>{{/if}}
      <div class="webkite-group">

        {{#each this~}}
          <section class="webkite-result">
            <div class="webkite-block-group{{#any (find ../../facets name="Price Per Bottle" empty=true) (find ../../facets name="Price Per Case" empty=true)}} webkite-prices-single{{/any}}">
              <div class="webkite-block webkite-block-seventy">
                {{#facet name="Image URL"}}<div class="webkite-image-wrapper"><img src="{{displayValue}}"/></div>{{/facet~}}
                <div class="webkite-result-body">
                  {{#any (find facets name="Vintage") (find facets name="Varietal")}}
                    <div class="webkite-subheadline">
                      {{~#facet name="Vintage"}}<span class="webkite-vintage">{{displayValue}}</span>{{/facet}}
                      {{~#facet name="Varietal"~}}
                        <span class="webkite-varietal">
                          {{~#if filterable}}
                            {{~#each values~}}
                              <a href="#" class="webkite-add-filter" data-facet="{{../name}}" data-operator="is" data-value="{{this}}">{{this}}</a>
                              {{~#unless @last}}/{{/unless~}}
                            {{~/each}}
                          {{~else}}
                            {{~#each values}}{{this}}{{#unless @last}}/{{/unless}}{{/each}}
                          {{~/if~}}
                        </span>
                      {{~/facet~}}
                    </div>
                  {{/any}}
                  {{#any (find facets name="Winery") (find facets name="Wine Name")}}
                    <h2 class="webkite-headline">
                      {{~#facet name="Winery"}}
                        {{~#if filterable~}}
                          {{~#each values~}}
                            <a href="#" class="webkite-add-filter webkite-winery"  data-facet="{{../name}}" data-operator="is" data-value="{{this}}">{{this}}</a>
                            {{~#unless @last}}/{{/unless~}}
                          {{~/each}}
                        {{~else~}}
                          <span class="webkite-winery">{{displayValue}}</span>
                        {{~/if}}
                      {{~/facet}}
                      {{#facet name="Wine Name"}}<span class="webkite-wine-name">{{displayValue}}</span>{{/facet~}}
                    </h2>
                  {{/any}}

                  <div class="webkite-block-group webkite-prices until-md">
                    {{~#unless (find ../../facets name="Price Per Bottle" empty=true)~}}
                      <div class="webkite-block webkite-block-fifty webkite-bottle">
                        <span class="webkite-price">
                          <span class="webkite-price-label">{{t "bottle" default="bottle"}}</span>
                          {{#facet name="Price Per Bottle"~}}<span class="webkite-price-value" title="{{displayValue}}">{{displayValue}}</span>{{~/facet}}                
                          {{#unless (find facets name="Price Per Bottle")~}}-{{~/unless~}}
                        </span>
                      </div>
                    {{~/unless~}}
                    {{~#unless (find ../../facets name="Price Per Case" empty=true)~}}
                      <div class="webkite-block webkite-block-fifty webkite-case">
                        <span class="webkite-price">
                          <span class="webkite-price-label">{{t "case" default="case"}}</span>
                          {{#facet name="Price Per Case"~}}<span class="webkite-price-value" title="{{displayValue}}">{{displayValue}}</span>{{~/facet}}                
                          {{#unless (find facets name="Price Per Case")~}}-{{~/unless}}
                        </span>
                      </div>
                    {{~/unless~}}
                  </div><!-- block-group -->
 
                  
                  {{#any (find facets name="Region") (find facets name="State") (find facets name="Country") (find facets name="Winery Address") (find facets name="Winery URL")}}
                    <ul class="webkite-wine-block">
                      {{#any (find facets name="Region") (find facets name="State") (find facets name="Country")}}
                        <li class="webkite-providence">
                          {{~#facet name="Region"~}}
                            {{~#if filterable~}}
                              {{~#each values~}}
                                <a href="#" class="webkite-add-filter webkite-region"  data-facet="{{../name}}" data-operator="is" data-value="{{this}}">{{this}}</a>
                                {{~#unless @last}}/{{/unless~}}
                              {{~/each}}
                            {{~else~}}
                              <span class="webkite-region">{{~displayValue}}</span>
                            {{~/if~}}          
                          {{~/facet}}
                
                          {{~#facet name="State"}}
                            {{~#if filterable~}}
                              {{~#each values~}}
                                <a href="#" class="webkite-add-filter webkite-state"  data-facet="{{../name}}" data-operator="is" data-value="{{this}}">{{this}}</a>
                                {{~#unless @last}}/{{/unless~}}
                              {{~/each}}
                            {{~else~}}
                              <span class="webkite-state">{{~displayValue}}</span>
                            {{~/if~}}          
                          {{~/facet}}
                
                          {{~#facet name="Country"}}
                            {{~#if filterable~}}
                              {{~#each values~}}
                                <a href="#" class="webkite-add-filter webkite-country"  data-facet="{{../name}}" data-operator="is" data-value="{{this}}">{{this}}</a>
                                {{~#unless @last}}/{{/unless~}}
                              {{~/each}}
                            {{~else~}}
                              <span class="webkite-country">{{~displayValue}}</span>
                            {{~/if~}}          
                          {{~/facet~}}
                        </li>
                      {{/any}}
                      
                      {{#facet name="Winery Address"}}
                        <li class="webkite-address">{{displayValue}}</li>
                      {{/facet}}
                      {{#facet name="Winery URL"}}
                        <li class="webkite-website"><a href="{{displayValue}}" target="_blank">{{t "website" default="website"}}</a></li>
                      {{/facet}}
                    </ul>
                  {{/any}}
                  
                  {{#facet name="Tasting Notes"~}}<p class="webkite-wine-block">{{displayValue}}</p>{{~/facet}}
                  
                  {{#any (find facets name="Bottles In Stock") (find facets name="Bottle Size") (find facets name="Rating")}}
                    <ul class="webkite-wine-block webkite-wine-extra-detail">
                      {{~#facet name="Rating"~}}
                        <li>{{displayName}} {{displayValue}}</li>
                      {{~/facet~}}
                      {{~#facet name="Bottles In Stock"~}}
                        <li>{{displayValue}} {{downcase displayName}}</li>
                      {{~/facet~}}
                      {{~#facet name="Bottle Size"~}}
                        <li>{{displayValue}}</li>
                      {{~/facet~}}
                    </ul>
                  {{/any}}                                 
                </div> <!-- webkite-result-body -->
              </div><!--
    
           --><div class="webkite-block webkite-block-thirty webkite-prices-wrap md-only">
                <div class="webkite-block-group webkite-prices">
                  {{~#unless (find ../../facets name="Price Per Bottle" empty=true)~}}
                    <div class="webkite-block webkite-block-fifty webkite-bottle">
                      <span class="webkite-price">
                        <span class="webkite-price-label">{{t "bottle" default="bottle"}}</span>
                        {{~#facet name="Price Per Bottle"~}}<span class="webkite-price-value" title="{{displayValue}}">{{displayValue}}</span>{{~/facet~}}                
                        {{~#unless (find facets name="Price Per Bottle")~}}-{{~/unless~}}
                      </span>
                    </div>
                  {{~/unless~}}
                  {{~#unless (find ../../facets name="Price Per Case" empty=true)~}}
                    <div class="webkite-block webkite-block-fifty webkite-case">
                      <span class="webkite-price">
                        <span class="webkite-price-label">{{t "case" default="case"}}</span>
                        {{~#facet name="Price Per Case"~}}<span class="webkite-price-value" title="{{displayValue}}">{{displayValue}}</span>{{~/facet~}}                
                        {{~#unless (find facets name="Price Per Case")~}}-{{~/unless~}}
                      </span>
                    </div>
                  {{~/unless~}}
                </div><!-- block-group -->
              </div>
              
            </div><!-- block-group -->
          </section>
        {{/each}}
      </div>
    {{/each}}
  {{else}}
    {{>noresult}}
  {{/if}}
</div>

{{>footer}}